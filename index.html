<!DOCTYPE html>
<html>

<head>
    <title>Google Sheets Cycle on Samsung TV</title>
    <style>
        iframe {
            width: 100%;
            height: 100vh;
            border: none;
        }

        body {
            margin: 0;
        }
    </style>
</head>

<body>
    <iframe id="sheetFrame" src=""></iframe>
    <script>
        // Configuration
        // Google Sheet Shared Link
        // https://docs.google.com/spreadsheets/d/1tZ88bd4ZVMwA-oZG00IwgGwbLPkh2ANzbzMUb7Ptzmc/edit?usp=sharing
        const spreadsheetId = '1tZ88bd4ZVMwA-oZG00IwgGwbLPkh2ANzbzMUb7Ptzmc'; // Replace with your Google Sheet ID
        const apiKey = 'AIzaSyCCKJH6wStoEgZcPW-yn8W8k0MehfxTm3Y'; // Replace with your Google Sheets API key
        const sheetBaseUrl = 'https://docs.google.com/spreadsheets/d/' + spreadsheetId + '/edit#gid=';
        alert(sheetBaseUrl);

        // Fetch list of sheets in the spreadsheet
        async function getSheetList() {
            const response = await fetch(
                `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}?fields=sheets.properties&key=${apiKey}`
            );
      const data = await response.json();
      return data.sheets.map(sheet => sheet.properties.sheetId);
    }

    // Cycle through sheets
    async function cycleSheets() {
      const sheetIds = await getSheetList();
      let currentIndex = 0;

      function displaySheet() {
        const sheetId = sheetIds[currentIndex];
        const iframe = document.getElementById('sheetFrame');
        iframe.src = sheetBaseUrl + sheetId; // Update iframe to show specific sheet
        currentIndex = (currentIndex + 1) % sheetIds.length; // Move to next sheet
      }

      // Initial display
      displaySheet();

      // Cycle every 10 seconds
      setInterval(displaySheet, 10000);
    }

    // Start cycling
    cycleSheets().catch(error => console.error('Error:', error));
    </script>
</body>

</html>
